<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Secure Mobile Vault Format (SMVF)</title><script>
function anchorRewrite() {
  map = { };
  if (window.location.hash.length >= 1) {
    var fragid = window.location.hash.substr(1);
    if (fragid) {
      if (! document.getElementById(fragid)) {
        var prefix = "rfc.";
        var mapped = map[fragid];
        if (mapped) {
          window.location.hash = mapped;
        } else if (fragid.indexOf("section-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(8).replace("-",".p.");
        } else if (fragid.indexOf("appendix-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(9).replace("-",".p.");
        } else if (fragid.indexOf("s-") == 0) {
          var postfix = fragid.substring(2);
          if (postfix.startsWith("abstract")) {
            window.location.hash = prefix + postfix;
          } else if (postfix.startsWith("note-")) {
            window.location.hash = prefix + "note." + postfix.substring(5).replace("-",".p.");
          } else {
            window.location.hash = prefix + "section." + postfix.replace("-",".p.");
          }
        } else if (fragid.indexOf("p-") == 0) {
          var r = fragid.substring(2);
          var p = r.indexOf("-");
          if (p >= 0) {
            window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
          }
        }
      }
    }  
  }
}
window.addEventListener('hashchange', anchorRewrite);
window.addEventListener('DOMContentLoaded', anchorRewrite);
</script><!--Specified as xml2rfc-ext-css-contents--><style>
body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}</style><link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="License" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Design Goals" href="#rfc.section.2"><link rel="Chapter" title="3 File Overview" href="#rfc.section.3"><link rel="Chapter" title="4 File Header" href="#rfc.section.4"><link rel="Chapter" title="5 Section Model" href="#rfc.section.5"><link rel="Chapter" title="6 Section Types" href="#rfc.section.6"><link rel="Chapter" title="7 KDF Parameters Section" href="#rfc.section.7"><link rel="Chapter" title="8 Crypto Parameters Section" href="#rfc.section.8"><link rel="Chapter" title="9 Encrypted Vault Section" href="#rfc.section.9"><link rel="Chapter" title="10 Vault Payload Structure" href="#rfc.section.10"><link rel="Chapter" title="11 Vault Entry Structure" href="#rfc.section.11"><link rel="Chapter" title="12 Authentication and Integrity" href="#rfc.section.12"><link rel="Chapter" title="13 Atomic Update Requirements" href="#rfc.section.13"><link rel="Chapter" title="14 Memory Handling Requirements" href="#rfc.section.14"><link rel="Chapter" title="15 Forward Compatibility Rules" href="#rfc.section.15"><link rel="Chapter" title="16 Explicit Non-Goals" href="#rfc.section.16"><link rel="Chapter" title="17 Threat Model Summary" href="#rfc.section.17"><link rel="Chapter" title="18 Rationale and ZXTX Lineage" href="#rfc.section.18"><link rel="Chapter" title="19 References" href="#rfc.section.19"><link rel="Chapter" title="20 Normative References" href="#rfc.section.20"><link rel="Appendix" title="Acknowledgments" href="#rfc.section.unnumbered-1"><meta name="viewport" content="initial-scale=1"><meta name="generator" content="http://greenbytes.de/tech/webdav/rfcxml.xslt, Revision 1.1615, 2025/10/02 05:43:22, XSLT vendor: libxslt http://xmlsoft.org/XSLT/, via: https://github.com/cabo/kramdown-rfc version 1.7.30 (Ruby 3.4.7)"><meta name="keywords" content="Internet-Draft"><link rel="schema.dcterms" href="http://purl.org/dc/terms/"><meta name="dcterms.creator" content="Keskilammi, O."><meta name="dcterms.issued" content="2026-01-03"><meta name="dcterms.abstract" content="The Secure Mobile Vault Format (SMVF) defines a binary container format for storing encrypted password vaults on mobile devices. The format is designed to be offline-first, zero-knowledge, cryptographically robust, and forward-compatible. SMVF specifies strict structural layout, authenticated encryption, and deterministic metadata handling suitable for constrained mobile environments."><meta name="description" content="The Secure Mobile Vault Format (SMVF) defines a binary container format for storing encrypted password vaults on mobile devices. The format is designed to be offline-first, zero-knowledge, cryptographically robust, and forward-compatible. SMVF specifies strict structural layout, authenticated encryption, and deterministic metadata handling suitable for constrained mobile environments."></head><body><header><table class="header" id="rfc.headerblock"><tbody><tr><td class="left">Network Working Group</td><td class="right">O. Keskilammi</td></tr><tr><td class="left">Internet-Draft</td><td class="right">January 3, 2026</td></tr><tr><td class="left">Intended status: Informational</td><td class="right"></td></tr><tr><td class="left">Expires: July 7, 2026</td><td class="right"></td></tr></tbody></table><div id="rfc.title"><h1>Secure Mobile Vault Format (SMVF)</h1><div class="filename"><a href="https://datatracker.ietf.org/doc/draft-voyager-svm-specification" class="smpl">draft-voyager-svm-specification-latest</a></div></div></header><section><h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2><div id="rfc.abstract.p.1"><p>The Secure Mobile Vault Format (SMVF) defines a binary container format for storing encrypted password vaults on mobile devices. The format is designed to be offline-first, zero-knowledge, cryptographically robust, and forward-compatible. SMVF specifies strict structural layout, authenticated encryption, and deterministic metadata handling suitable for constrained mobile environments.<a class="self" href="#rfc.abstract.p.1">¶</a></p></div></section><section class="note rfcEditorRemove"><h2 id="rfc.note.1"><a href="#rfc.note.1">Discussion Venues</a></h2><div id="rfc.note.1.p.1"><p>This note is to be removed before publishing as an RFC.<a class="self" href="#rfc.note.1.p.1">¶</a></p></div><div id="rfc.note.1.p.2"><p>Source for this draft and an issue tracker can be found at &lt;<a href="https://github.com/voyager-2021/svm-specification">https://github.com/voyager-2021/svm-specification</a>&gt;.<a class="self" href="#rfc.note.1.p.2">¶</a></p></div></section><section id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><div id="rfc.boilerplate.1.p.1"><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.<a class="self" href="#rfc.boilerplate.1.p.1">¶</a></p></div><div id="rfc.boilerplate.1.p.2"><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a>.<a class="self" href="#rfc.boilerplate.1.p.2">¶</a></p></div><div id="rfc.boilerplate.1.p.3"><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress”.<a class="self" href="#rfc.boilerplate.1.p.3">¶</a></p></div><div id="rfc.boilerplate.1.p.4"><p>This Internet-Draft will expire on July 7, 2026.<a class="self" href="#rfc.boilerplate.1.p.4">¶</a></p></div></section><section id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><div id="rfc.boilerplate.2.p.1"><p>Copyright (c) 2026 IETF Trust and the persons identified as the document authors. All rights reserved.<a class="self" href="#rfc.boilerplate.2.p.1">¶</a></p></div><div id="rfc.boilerplate.2.p.2"><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Revised BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Revised BSD License.<a class="self" href="#rfc.boilerplate.2.p.2">¶</a></p></div></section><hr class="noprint"><nav id="rfc.toc"><h2 class="np"><a href="#rfc.toc">Table of Contents</a></h2><ul class="toc"><li><a href="#rfc.section.1">1.</a>   <a href="#introduction">Introduction</a></li><li><a href="#rfc.section.2">2.</a>   <a href="#design-goals">Design Goals</a></li><li><a href="#rfc.section.3">3.</a>   <a href="#file-overview">File Overview</a></li><li><a href="#rfc.section.4">4.</a>   <a href="#file-header">File Header</a></li><li><a href="#rfc.section.5">5.</a>   <a href="#sec-model">Section Model</a></li><li><a href="#rfc.section.6">6.</a>   <a href="#sec-types">Section Types</a></li><li><a href="#rfc.section.7">7.</a>   <a href="#kdf-parameters-section">KDF Parameters Section</a></li><li><a href="#rfc.section.8">8.</a>   <a href="#crypto-parameters-section">Crypto Parameters Section</a></li><li><a href="#rfc.section.9">9.</a>   <a href="#encrypted-vault-section">Encrypted Vault Section</a></li><li><a href="#rfc.section.10">10.</a>   <a href="#vault-payload-structure">Vault Payload Structure</a></li><li><a href="#rfc.section.11">11.</a>   <a href="#vault-entry-structure">Vault Entry Structure</a></li><li><a href="#rfc.section.12">12.</a>   <a href="#authentication-and-integrity">Authentication and Integrity</a></li><li><a href="#rfc.section.13">13.</a>   <a href="#atomic-update-requirements">Atomic Update Requirements</a></li><li><a href="#rfc.section.14">14.</a>   <a href="#memory-handling-requirements">Memory Handling Requirements</a></li><li><a href="#rfc.section.15">15.</a>   <a href="#forward-compatibility-rules">Forward Compatibility Rules</a></li><li><a href="#rfc.section.16">16.</a>   <a href="#explicit-non-goals">Explicit Non-Goals</a></li><li><a href="#rfc.section.17">17.</a>   <a href="#threat-model-summary">Threat Model Summary</a></li><li><a href="#rfc.section.18">18.</a>   <a href="#rationale-and-zxtx-lineage">Rationale and ZXTX Lineage</a></li><li><a href="#rfc.section.19">19.</a>   <a href="#references">References</a><ul><li><a href="#rfc.section.19.1">19.1.</a>   <a href="#normative-references">Normative References</a></li><li><a href="#rfc.section.19.2">19.2.</a>   <a href="#informative-references">Informative References</a></li></ul></li><li><a href="#rfc.section.20">20.</a>   <a href="#rfc.references">Normative References</a></li><li><a href="#acknowledgments">Acknowledgments</a></li><li><a href="#rfc.authors">Author's Address</a></li></ul></nav><hr class="noprint"><section id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a> <a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>The Secure Mobile Vault Format (SMVF) defines a binary container format for storing encrypted password vaults on mobile devices. The format is designed to be offline-first, zero-knowledge, cryptographically robust, and forward-compatible.<a class="self" href="#rfc.section.1.p.1">¶</a></p></div><div id="rfc.section.1.p.2"><p>SMVF follows ZXTX-style principles including explicit headers, typed sections, cryptographic framing, and strict versioning, while remaining minimal and suitable for mobile environments.<a class="self" href="#rfc.section.1.p.2">¶</a></p></div><div id="rfc.section.1.p.3"><p>The key words MUST, MUST NOT, REQUIRED, SHOULD, SHOULD NOT, and MAY in this document are to be interpreted as described in RFC 2119.<a class="self" href="#rfc.section.1.p.3">¶</a></p></div></section><hr class="noprint"><section id="design-goals"><h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a> <a href="#design-goals">Design Goals</a></h2><div id="rfc.section.2.p.1" class="avoidbreakafter"><p>The format is designed to meet the following goals:<a class="self" href="#rfc.section.2.p.1">¶</a></p></div><div id="rfc.section.2.p.2"><ol><li>Provide zero-knowledge encryption where vault contents cannot be recovered without the master password.</li><li>Support offline-only operation with no network dependencies.</li><li>Be safe for mobile storage, including crash-safe atomic updates.</li><li>Use authenticated encryption to ensure confidentiality and integrity.</li><li>Allow future evolution without breaking existing vaults.</li><li>Remain auditable and deterministic in layout.</li></ol></div></section><hr class="noprint"><section id="file-overview"><h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a> <a href="#file-overview">File Overview</a></h2><div id="rfc.section.3.p.1" class="avoidbreakafter"><p>An SMVF file consists of the following components, in order:<a class="self" href="#rfc.section.3.p.1">¶</a></p></div><div id="rfc.section.3.p.2"><ul><li>File Header (fixed-size)</li><li>KDF Parameters Section</li><li>Crypto Parameters Section</li><li>Encrypted Vault Section</li><li>Optional Footer</li></ul></div><div id="rfc.section.3.p.3"><p>All multi-octet integer fields are encoded in network byte order (big-endian). The file is tightly packed and contains no padding.<a class="self" href="#rfc.section.3.p.3">¶</a></p></div><div id="rfc.section.3.p.4"><p>The standard file extension is ".smvf".<a class="self" href="#rfc.section.3.p.4">¶</a></p></div></section><hr class="noprint"><section id="file-header"><h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a> <a href="#file-header">File Header</a></h2><div id="rfc.section.4.p.1"><p>The file header is a fixed-size structure of 32 octets.<a class="self" href="#rfc.section.4.p.1">¶</a></p></div><div id="rfc.section.4.p.2" class="avoidbreakafter"><p>The header contains the following fields:<a class="self" href="#rfc.section.4.p.2">¶</a></p></div><div id="rfc.section.4.p.3"><ul><li>Magic (4 octets) Identifies the file as an SMVF container. The value MUST be the ASCII string "SMVF".</li><li>Major Version (2 octets) Indicates the major format version. Readers MUST reject files with unsupported major versions.</li><li>Minor Version (2 octets) Indicates backward-compatible revisions.</li><li>Header Length (4 octets) Total length in octets of the header plus all mandatory sections preceding the encrypted payload.</li><li>Flags (4 octets) Bitmask defining file properties.</li><li>File UUID (16 octets) Randomly generated unique identifier. This value is non-secret and MUST NOT be reused.</li></ul></div><div id="rfc.section.4.p.4" class="avoidbreakafter"><p>The following header flags are defined:<a class="self" href="#rfc.section.4.p.4">¶</a></p></div><div id="rfc.section.4.p.5"><ul><li>Bit 0: Encrypted payload present (MUST be set)</li><li>Bit 1: Footer present</li><li>Bits 2–31: Reserved and MUST be zero</li></ul></div></section><hr class="noprint"><section id="sec-model"><h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a> <a href="#sec-model">Section Model</a></h2><div id="rfc.section.5.p.1"><p>Sections follow a typed-length-value (TLV) model.<a class="self" href="#rfc.section.5.p.1">¶</a></p></div><div id="rfc.section.5.p.2" class="avoidbreakafter"><p>Each section consists of:<a class="self" href="#rfc.section.5.p.2">¶</a></p></div><div id="rfc.section.5.p.3"><ul><li>Section Type (2 octets)</li><li>Section Length (4 octets)</li><li>Section Value (variable length)</li></ul></div><div id="rfc.section.5.p.4"><p>The section length specifies the length of the section value only.<a class="self" href="#rfc.section.5.p.4">¶</a></p></div><div id="rfc.section.5.p.5"><p>Unknown section types MUST be skipped using the length field. The section order defined in this specification MUST be preserved for version 1.0.<a class="self" href="#rfc.section.5.p.5">¶</a></p></div></section><hr class="noprint"><section id="sec-types"><h2 id="rfc.section.6" class="np"><a href="#rfc.section.6">6.</a> <a href="#sec-types">Section Types</a></h2><div id="rfc.section.6.p.1" class="avoidbreakafter"><p>The following section types are defined:<a class="self" href="#rfc.section.6.p.1">¶</a></p></div><div id="rfc.section.6.p.2"><ul><li>0x01: KDF Parameters Section (REQUIRED)</li><li>0x02: Crypto Parameters Section (REQUIRED)</li><li>0x03: Encrypted Vault Section (REQUIRED)</li><li>0x7F: Reserved for future use</li></ul></div><div id="rfc.section.6.p.3"><p>No section identifier may be reused for a different purpose.<a class="self" href="#rfc.section.6.p.3">¶</a></p></div></section><hr class="noprint"><section id="kdf-parameters-section"><h2 id="rfc.section.7" class="np"><a href="#rfc.section.7">7.</a> <a href="#kdf-parameters-section">KDF Parameters Section</a></h2><div id="rfc.section.7.p.1"><p>This section defines how the encryption key is derived from the master password.<a class="self" href="#rfc.section.7.p.1">¶</a></p></div><div id="rfc.section.7.p.2" class="avoidbreakafter"><p>The section value contains the following fields:<a class="self" href="#rfc.section.7.p.2">¶</a></p></div><div id="rfc.section.7.p.3"><ul><li>KDF Algorithm (1 octet)</li><li>Salt Length (1 octet)</li><li>Salt (variable length)</li><li>Cost Parameter A (4 octets)</li><li>Cost Parameter B (4 octets)</li><li>Cost Parameter C (4 octets)</li></ul></div><div id="rfc.section.7.p.4" class="avoidbreakafter"><p>The following KDF Algorithm identifiers are defined:<a class="self" href="#rfc.section.7.p.4">¶</a></p></div><div id="rfc.section.7.p.5"><ul><li>0x01: Argon2id</li><li>0x02: scrypt</li></ul></div><div id="rfc.section.7.p.6"><p>The salt is not secret and MUST be generated randomly per vault.<a class="self" href="#rfc.section.7.p.6">¶</a></p></div><div id="rfc.section.7.p.7" class="avoidbreakafter"><p>For Argon2id, the parameters are defined as follows:<a class="self" href="#rfc.section.7.p.7">¶</a></p></div><div id="rfc.section.7.p.8"><ul><li>Parameter A: Memory cost in KiB</li><li>Parameter B: Iteration count</li><li>Parameter C: Degree of parallelism</li></ul></div><div id="rfc.section.7.p.9" class="avoidbreakafter"><p>For scrypt, the parameters are defined as follows:<a class="self" href="#rfc.section.7.p.9">¶</a></p></div><div id="rfc.section.7.p.10"><ul><li>Parameter A: N (CPU/memory cost)</li><li>Parameter B: r</li><li>Parameter C: p</li></ul></div><div id="rfc.section.7.p.11"><p>Implementations SHOULD tune parameters for mobile hardware while maintaining resistance to offline attacks.<a class="self" href="#rfc.section.7.p.11">¶</a></p></div></section><hr class="noprint"><section id="crypto-parameters-section"><h2 id="rfc.section.8" class="np"><a href="#rfc.section.8">8.</a> <a href="#crypto-parameters-section">Crypto Parameters Section</a></h2><div id="rfc.section.8.p.1"><p>This section defines the encryption algorithm and parameters used to protect the vault payload.<a class="self" href="#rfc.section.8.p.1">¶</a></p></div><div id="rfc.section.8.p.2" class="avoidbreakafter"><p>The section value contains the following fields:<a class="self" href="#rfc.section.8.p.2">¶</a></p></div><div id="rfc.section.8.p.3"><ul><li>Cipher Algorithm (1 octet)</li><li>Key Length (1 octet)</li><li>Nonce Length (1 octet)</li><li>Authentication Tag Length (1 octet)</li><li>Nonce (variable length)</li></ul></div><div id="rfc.section.8.p.4" class="avoidbreakafter"><p>The following Cipher Algorithm identifiers are defined:<a class="self" href="#rfc.section.8.p.4">¶</a></p></div><div id="rfc.section.8.p.5"><ul><li>0x01: AES-256-GCM</li><li>0x02: ChaCha20-Poly1305</li></ul></div><div id="rfc.section.8.p.6"><p>The nonce MUST be generated randomly per vault file. The authentication tag is embedded in the AEAD ciphertext and is not stored separately.<a class="self" href="#rfc.section.8.p.6">¶</a></p></div></section><hr class="noprint"><section id="encrypted-vault-section"><h2 id="rfc.section.9" class="np"><a href="#rfc.section.9">9.</a> <a href="#encrypted-vault-section">Encrypted Vault Section</a></h2><div id="rfc.section.9.p.1"><p>This section contains the encrypted vault payload.<a class="self" href="#rfc.section.9.p.1">¶</a></p></div><div id="rfc.section.9.p.2" class="avoidbreakafter"><p>The payload is produced using an AEAD construction with the following inputs:<a class="self" href="#rfc.section.9.p.2">¶</a></p></div><div id="rfc.section.9.p.3"><ul><li>The encryption key is derived from the master password using the KDF Parameters Section.</li><li>The nonce is taken from the Crypto Parameters Section.</li><li>The additional authenticated data consists of the File Header, the KDF Parameters Section, and the Crypto Parameters Section.</li></ul></div><div id="rfc.section.9.p.4"><p>All metadata is authenticated but not encrypted. Any modification to these components MUST cause decryption failure.<a class="self" href="#rfc.section.9.p.4">¶</a></p></div></section><hr class="noprint"><section id="vault-payload-structure"><h2 id="rfc.section.10" class="np"><a href="#rfc.section.10">10.</a> <a href="#vault-payload-structure">Vault Payload Structure</a></h2><div id="rfc.section.10.p.1"><p>Before encryption, the vault payload is serialized as UTF-8 encoded JSON.<a class="self" href="#rfc.section.10.p.1">¶</a></p></div><div id="rfc.section.10.p.2" class="avoidbreakafter"><p>The top-level object contains the following fields:<a class="self" href="#rfc.section.10.p.2">¶</a></p></div><div id="rfc.section.10.p.3"><ul><li>vault_version: Integer indicating the logical vault schema version</li><li>created: ISO 8601 UTC timestamp</li><li>updated: ISO 8601 UTC timestamp</li><li>entries: Array of vault entries</li><li>metadata: Optional application-defined metadata</li></ul></div></section><hr class="noprint"><section id="vault-entry-structure"><h2 id="rfc.section.11" class="np"><a href="#rfc.section.11">11.</a> <a href="#vault-entry-structure">Vault Entry Structure</a></h2><div id="rfc.section.11.p.1" class="avoidbreakafter"><p>Each vault entry is a JSON object containing the following fields:<a class="self" href="#rfc.section.11.p.1">¶</a></p></div><div id="rfc.section.11.p.2"><ul><li>id: UUID version 4 string</li><li>type: Entry type identifier</li><li>title: Human-readable name</li><li>fields: Key-value mapping of entry fields</li><li>notes: Optional freeform text</li><li>tags: Optional array of strings</li><li>created: ISO 8601 UTC timestamp</li><li>updated: ISO 8601 UTC timestamp</li></ul></div><div id="rfc.section.11.p.3"><p>The type field allows future extension to support non-password secrets.<a class="self" href="#rfc.section.11.p.3">¶</a></p></div></section><hr class="noprint"><section id="authentication-and-integrity"><h2 id="rfc.section.12" class="np"><a href="#rfc.section.12">12.</a> <a href="#authentication-and-integrity">Authentication and Integrity</a></h2><div id="rfc.section.12.p.1"><p>The format relies exclusively on AEAD for security guarantees.<a class="self" href="#rfc.section.12.p.1">¶</a></p></div><div id="rfc.section.12.p.2" class="avoidbreakafter"><p>The following properties are provided:<a class="self" href="#rfc.section.12.p.2">¶</a></p></div><div id="rfc.section.12.p.3"><ul><li>Confidentiality of vault contents</li><li>Integrity of vault contents</li><li>Integrity and authenticity of metadata</li></ul></div><div id="rfc.section.12.p.4"><p>No separate MAC or digital signature is required in version 1.0.<a class="self" href="#rfc.section.12.p.4">¶</a></p></div></section><hr class="noprint"><section id="atomic-update-requirements"><h2 id="rfc.section.13" class="np"><a href="#rfc.section.13">13.</a> <a href="#atomic-update-requirements">Atomic Update Requirements</a></h2><div id="rfc.section.13.p.1"><p>Implementations MUST perform updates atomically to prevent vault corruption.<a class="self" href="#rfc.section.13.p.1">¶</a></p></div><div id="rfc.section.13.p.2" class="avoidbreakafter"><p>A recommended procedure is as follows:<a class="self" href="#rfc.section.13.p.2">¶</a></p></div><div id="rfc.section.13.p.3"><ol><li>Write the updated vault to a temporary file.</li><li>Flush and synchronize the file.</li><li>Atomically rename the temporary file over the existing vault.</li><li>Optionally retain a backup copy.</li></ol></div><div id="rfc.section.13.p.4"><p>Mobile operating systems guarantee atomic rename operations within the same filesystem.<a class="self" href="#rfc.section.13.p.4">¶</a></p></div></section><hr class="noprint"><section id="memory-handling-requirements"><h2 id="rfc.section.14" class="np"><a href="#rfc.section.14">14.</a> <a href="#memory-handling-requirements">Memory Handling Requirements</a></h2><div id="rfc.section.14.p.1" class="avoidbreakafter"><p>Implementations MUST enforce the following requirements:<a class="self" href="#rfc.section.14.p.1">¶</a></p></div><div id="rfc.section.14.p.2"><ul><li>Derived encryption keys MUST NOT be persisted.</li><li>Keys MUST be zeroized on lock or application backgrounding.</li><li>Decrypted vault data MUST reside only in memory and MUST be discarded on lock or suspension.</li></ul></div></section><hr class="noprint"><section id="forward-compatibility-rules"><h2 id="rfc.section.15" class="np"><a href="#rfc.section.15">15.</a> <a href="#forward-compatibility-rules">Forward Compatibility Rules</a></h2><div id="rfc.section.15.p.1"><p>Readers MUST reject files with unsupported major versions.<a class="self" href="#rfc.section.15.p.1">¶</a></p></div><div id="rfc.section.15.p.2"><p>Readers MUST ignore unknown section types.<a class="self" href="#rfc.section.15.p.2">¶</a></p></div><div id="rfc.section.15.p.3"><p>Writers MUST preserve section ordering and MUST NOT reuse section identifiers.<a class="self" href="#rfc.section.15.p.3">¶</a></p></div></section><hr class="noprint"><section id="explicit-non-goals"><h2 id="rfc.section.16" class="np"><a href="#rfc.section.16">16.</a> <a href="#explicit-non-goals">Explicit Non-Goals</a></h2><div id="rfc.section.16.p.1" class="avoidbreakafter"><p>The format intentionally excludes:<a class="self" href="#rfc.section.16.p.1">¶</a></p></div><div id="rfc.section.16.p.2"><ul><li>Cloud synchronization</li><li>Compression</li><li>Partial encryption</li><li>Password reuse detection</li><li>Replay protection</li></ul></div></section><hr class="noprint"><section id="threat-model-summary"><h2 id="rfc.section.17" class="np"><a href="#rfc.section.17">17.</a> <a href="#threat-model-summary">Threat Model Summary</a></h2><div id="rfc.section.17.p.1" class="avoidbreakafter"><p>The format mitigates:<a class="self" href="#rfc.section.17.p.1">¶</a></p></div><div id="rfc.section.17.p.2"><ul><li>Offline file theft</li><li>Unauthorized modification</li><li>Metadata tampering</li></ul></div><div id="rfc.section.17.p.3" class="avoidbreakafter"><p>The format does not mitigate:<a class="self" href="#rfc.section.17.p.3">¶</a></p></div><div id="rfc.section.17.p.4"><ul><li>Compromised or rooted operating systems</li><li>Active runtime memory attacks</li><li>Screen capture malware</li></ul></div></section><hr class="noprint"><section id="rationale-and-zxtx-lineage"><h2 id="rfc.section.18" class="np"><a href="#rfc.section.18">18.</a> <a href="#rationale-and-zxtx-lineage">Rationale and ZXTX Lineage</a></h2><div id="rfc.section.18.p.1"><p>SMVF adopts ZXTX-style design principles including structured sections, explicit cryptographic framing, metadata authentication, and specification-first development.<a class="self" href="#rfc.section.18.p.1">¶</a></p></div><div id="rfc.section.18.p.2"><p>The format simplifies ZXTX concepts to better suit mobile constraints and usability requirements.<a class="self" href="#rfc.section.18.p.2">¶</a></p></div></section><hr class="noprint"><section id="references"><h2 id="rfc.section.19" class="np"><a href="#rfc.section.19">19.</a> <a href="#references">References</a></h2><section id="normative-references"><h3 id="rfc.section.19.1"><a href="#rfc.section.19.1">19.1.</a> <a href="#normative-references">Normative References</a></h3><div id="rfc.section.19.1.p.1"><p><a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a> Bradner, S., "Key words for use in RFCs to Indicate Requirement Levels", BCP 14, RFC 2119.<a class="self" href="#rfc.section.19.1.p.1">¶</a></p></div></section><section id="informative-references"><h3 id="rfc.section.19.2"><a href="#rfc.section.19.2">19.2.</a> <a href="#informative-references">Informative References</a></h3></section></section><section id="sec-normative-references" class="np"><div id="rfc.references"><h2 id="rfc.section.20"><a href="#rfc.section.20">20.</a> Normative References</h2><dl class="reference"><dt id="RFC2119">[<a href="#RFC2119" class="smpl">RFC2119</a>]</dt><dd>Bradner, S., “<a href="https://www.rfc-editor.org/rfc/rfc2119.html">Key words for use in RFCs to Indicate Requirement Levels</a>”, <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>, RFC 2119, <a href="https://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March 1997, &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd></dl></div></section><hr class="noprint"><section id="acknowledgments"><h2 id="rfc.section.unnumbered-1" class="np"><a href="#acknowledgments">Acknowledgments</a></h2><div id="rfc.section.unnumbered-1.p.1"><p>TODO acknowledge.<a class="self" href="#rfc.section.unnumbered-1.p.1">¶</a></p></div></section><hr class="noprint"><section id="rfc.authors" class="np"><h2><a href="#rfc.authors">Author's Address</a></h2><address><b>Ohto Keskilammi</b><br>EMail: <a href="mailto:voyager-2019@outlook.com">voyager-2019@outlook.com</a></address></section></body></html>
